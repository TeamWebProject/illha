<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <!-- head 내용은 여기에 위치합니다. -->
    <!-- ... -->
    <title>비밀번호찾기</title>
    <link rel="stylesheet" type="text/css" th:href="@{/bootstrap.min.css}">
    <style>
        h2 {
            text-align: center;
            font-size: 20px;
        }

        body {
            padding: 20px;
        }


        /* 간격을 조절하기 위해 body에 패딩을 추가합니다. */
    </style>
</head>
<body class="m-0 p-0">
<!-- 비밀번호 찾기 폼 -->
<h2>비밀번호 찾기</h2>
<div class="container my-3">
    <form th:action="@{/member/findPassword}" method="post">
        <input type="hidden" name="verificationCodeSent" th:value="${verificationCodeSent}">
        <input type="hidden" name="verificationCode" th:value="${verificationCode}">
        <div class="mb-3">
            <label for="memberId" class="form-label">비밀번호를 찾으려는 아이디</label>
            <input type="text" name="memberId" id="memberId" class="form-control" required th:value="${param.memberId}">
        </div>
        <!-- 추가: 비밀번호 찾기 버튼을 누르면 인증번호가 전송되면, 인증번호 입력란이 나타납니다. -->
        <div th:if="${verificationCodeSent}">
            <div class="mb-3">
                <label for="verificationCode" class="form-label">인증번호</label>
                <input type="password" name="inputVerificationCode" id="verificationCode" class="form-control" required
                       th:value="${param.inputVerificationCode}">
            </div>
        </div>
        <!-- 메시지를 표시하는 부분 -->
        <div th:if="${message}">
            <p th:text="${message}"></p>
        </div>
        <button type="submit" class="btn btn-primary">다음</button>
        <!-- 수정: 새로운 비밀번호 입력 폼 -->
    </form>
    <div th:if="${verificationCodeValid}">
        <form th:action="@{/member/passwordReset}" method="post">
            <input type="hidden" name="memberId" th:value="${param.memberId}">
            <input type="hidden" name="verificationCode" th:value="${param.verificationCode}">
            <div class="mb-3">
                <label for="newPassword" class="form-label">새로운 비밀번호</label>
                <input type="password" name="newPassword" id="newPassword" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary">비밀번호 재설정</button>
        </form>
        <!-- 수정: 재설정이 완료된 후에 표시할 메시지 -->
        <div th:if="${message}">
            <p th:text="${message}"></p>
        </div>
        <!-- 추가: 비밀번호 재설정 성공 시 alert와 페이지 이동을 위한 스크립트 -->
    </div>

    <!-- 비밀번호 찾기 결과를 여기에 표시 -->
    <div th:if="${foundPassword}">
        <p th:text="${foundPassword}"></p>
    </div>

</div>

<script th:if="${param.resetSuccess}">
    console.log('스크립트 실행 확인');
    alert('비밀번호가 성공적으로 재설정되었습니다.');
       window.location.href = '/member/login';
</script>

</body>
</html>